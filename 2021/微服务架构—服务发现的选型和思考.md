一、 服务发现背景：

1.服务节点扩容，服务消费端应该快速及时的感知(地址、数量等)
2.服务节点不可用，及时剔除掉
3.当服务节点部署在多个可用区AZ，某个可用区不可用，需要自动切换或者手动切换
4.服务发现的背后的存储应该是分布式的，这样部分节点不可用的时候，也能提供基本的发现功能

总之，上述问题，使用文件配置或者DNS的方式不能解决上述问题，需要重新设计一套服务发现的方案


二、服务发现调用模式：


1.客户端发现模式
  例如：个经典代表就是Netflix提供的解决方案：Netflix Eureka 提供服务发现功能， Netflix Ribbon 作为一个通讯SDK库与客户端集成在一起提供负载均衡与故障转移。

2.服务端发现模式
例如： 一个代表是kubernetes的服务发现解决方案：运行在每个Node节点的kube-proxy会实时的watch Services和 Endpoints对象。


三、服务发现cap理论

 1.cp: zk 、etcd 解决分布式一致性存储的问题
2.ca： consul，较高可用性和一致性，对分区容错差一点，各个子系统保持ca,多数据中心
3.ap:放弃一致性，为了高可用，每个阶段只能用本地服务，nosql、euerka



> reference 
https://mp.weixin.qq.com/s/8vASJavOQrXw5bGEEMwd9Q
